# ARTHUR - ESP8266 ê°œì¸ë¹„ì„œ

**Autonomous Real-Time Home Utility Responder**

ESP8266 HW-364 ë³´ë“œ(OLED ë‚´ì¥)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ëª¨ë“ˆí˜• ê°œì¸ë¹„ì„œ. ESP8266ì˜ ê·¹ë„ë¡œ ì œí•œëœ ë©”ëª¨ë¦¬(ê°€ìš© í™ ~10-18KB) í™˜ê²½ì—ì„œ ë™ì‘í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

**Claw ë¶„ë¥˜**: AttoClaw â€” Claw ìƒíƒœê³„ì—ì„œ ê°€ì¥ ê·¹ì†Œ ë‹¨ìœ„ì˜ AI ì—ì´ì „íŠ¸

---

## ğŸ“Š í˜„ì¬ ìƒíƒœ

### êµ¬í˜„ í˜„í™© (ëª¨ë“ˆë³„)

| ëª¨ë“ˆ | êµ¬í˜„ | main.cpp í†µí•© | í…ŒìŠ¤íŠ¸ | ìƒíƒœ |
|------|------|----------------|--------|------|
| **EventBus** | âœ… 100% | âš ï¸ ë¯¸í†µí•© | âœ… 9ì¼€ì´ìŠ¤ | pub/sub í†µì‹  ì™„ë£Œ |
| **TimeManager** | âœ… 100% | âš ï¸ ë¯¸í†µí•© | âŒ ë¯¸êµ¬í˜„ | NTP ë™ê¸°í™” ì™„ë£Œ |
| **ConfigManager** | âœ… 100% | âš ï¸ ë¯¸í†µí•© | âŒ ë¯¸êµ¬í˜„ | JSON ì„¤ì • ì™„ë£Œ |
| **CacheManager** | âœ… 100% | âš ï¸ ë¯¸í†µí•© | âŒ ë¯¸êµ¬í˜„ | TTL ìºì‹œ ì™„ë£Œ |
| **ClockModule** | âœ… 100% | âš ï¸ ë¯¸í†µí•© | âŒ ë¯¸êµ¬í˜„ | OLED ì‹œê³„ ì™„ë£Œ |
| **SensorModule** | âœ… 100% | âš ï¸ ë¯¸í†µí•© | âŒ ë¯¸êµ¬í˜„ | BME280 ì„¼ì„œ ì™„ë£Œ |
| **WeatherModule** | âœ… 100% | âš ï¸ ë¯¸í†µí•© | âŒ ë¯¸êµ¬í˜„ | OpenWeatherMap API ì™„ë£Œ |
| **WiFiManager** | âœ… 100% | âœ… í†µí•© | N/A | Captive Portal ì™„ë£Œ |

### ì½”ë“œí’ˆì§ˆ í˜„í™©

| í•­ëª© | í˜„ì¬ ê°’ | ëª©í‘œ ê°’ | ë¹„ê³  |
|------|---------|---------|------|
| TRUST 5 ì ìˆ˜ | 15/25 (60%) | 23/25 (92%) | `.moai/specs/CODE-QUALITY/spec.md` |
| í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ | ~15% | 85% | EventBusë§Œ í…ŒìŠ¤íŠ¸ë¨ |
| String ìœ„ë°˜ | 1ê±´ | 0ê±´ | `weather_module.cpp:112` |
| ëª¨ë“ˆ í†µí•© | 0% | 100% | Phase 1 ì§„í–‰ ì¤‘ |

### ë¹Œë“œ í˜„í™©

| í•­ëª© | ê°’ |
|------|-----|
| Flash | 9.5% (365KB / 4MB) |
| RAM | 38.8% (31.7KB / 81.9KB) |
| Free Heap (WiFi ì—°ê²° í›„) | ~45KB |

---

## ğŸ¯ ê¸°ëŠ¥

### í˜„ì¬ ë™ì‘ ê¸°ëŠ¥ (Phase 0)

- âœ… **WiFi ì„¤ì •**: Captive Portalë¡œ ìŠ¤ë§ˆíŠ¸í°ì—ì„œ ì§ì ‘ ì„¤ì • (PC ë¶ˆí•„ìš”)
- âœ… **WiFi ìŠ¤ìº”**: ì„¤ì • í˜ì´ì§€ì—ì„œ ì£¼ë³€ AP ìë™ ìŠ¤ìº” í›„ ë“œë¡­ë‹¤ìš´ ì„ íƒ
- âœ… **OLED ë””ìŠ¤í”Œë ˆì´**: 2ìƒ‰ OLED (ìƒë‹¨ ë…¸ë‘ ìƒíƒœë°” + í•˜ë‹¨ íŒŒë‘ ì½˜í…ì¸ )
- âœ… **ìƒíƒœ í‘œì‹œ**: Setup Mode â†’ Connecting â†’ WiFi OK ë‹¨ê³„ë³„ í‘œì‹œ

### êµ¬í˜„ ì™„ë£Œ ë¯¸í†µí•© ê¸°ëŠ¥

- âš ï¸ **NTP ì‹œê³„**: TimeManager êµ¬í˜„ ì™„ë£Œ, main.cpp í†µí•© í•„ìš”
- âš ï¸ **ë‚ ì”¨ ì˜ˆë³´**: WeatherModule êµ¬í˜„ ì™„ë£Œ, main.cpp í†µí•© í•„ìš”
- âš ï¸ **ì‹¤ë‚´ í™˜ê²½ ëª¨ë‹ˆí„°ë§**: SensorModule êµ¬í˜„ ì™„ë£Œ, main.cpp í†µí•© í•„ìš”

### ê³„íšëœ ê¸°ëŠ¥ (Phase 2-4)

- ğŸ“‹ MQTT IoT ê¸°ê¸° ì œì–´
- ğŸ“‹ í‘¸ì‹œ ì•Œë¦¼ í‘œì‹œ
- ğŸ“‹ Home Assistant ì—°ë™ (PC í”„ë¡ì‹œ ê²½ìœ )
- ğŸ“‹ êµ¬ë…í˜• ë©€í‹° AI ì—ì´ì „íŠ¸ (ChatGPT/Claude/Gemini/Ollama)
- ğŸ“‹ Dual Mode (PC Enhanced / Standalone)

---

## ğŸ”§ WiFi ì„¤ì • ë°©ë²•

1. ìµœì´ˆ ë¶€íŒ… ì‹œ OLEDì— "Setup Mode" í‘œì‹œ
2. ìŠ¤ë§ˆíŠ¸í° WiFiì—ì„œ **ARTHUR** APì— ì—°ê²° (íŒ¨ìŠ¤ì›Œë“œ: `arthur123`)
3. ìë™ìœ¼ë¡œ ì„¤ì • í˜ì´ì§€ ì—´ë¦¼ (ë˜ëŠ” ë¸Œë¼ìš°ì €ì—ì„œ `http://192.168.4.1`)
4. ë¡œê·¸ì¸: `admin` / `arthur123`
5. **Scan WiFi** ë²„íŠ¼ìœ¼ë¡œ ì£¼ë³€ AP ìŠ¤ìº” â†’ ë“œë¡­ë‹¤ìš´ì—ì„œ ì„ íƒ
6. íŒ¨ìŠ¤ì›Œë“œ ì…ë ¥ â†’ Apply â†’ ìë™ ì¬ë¶€íŒ… í›„ WiFi ì—°ê²°
7. ì´í›„ ì¬ë¶€íŒ… ì‹œ ìë™ ì—°ê²°

> **WiFi ì¬ì„¤ì •**: ë¶€íŒ… ì‹œ FLASH ë²„íŠ¼ì„ ëˆ„ë¥´ê³  ìˆìœ¼ë©´ AP ëª¨ë“œ ê°•ì œ ì§„ì…

---

## ğŸ“¦ í•˜ë“œì›¨ì–´

### ë³´ë“œ: HW-364A/B

| í•­ëª© | ê°’ |
|------|-----|
| SoC | ESP8266EX (Tensilica LX106, 80/160MHz) |
| ëª¨ë“ˆ | ESP-12E / ESP-12F |
| Flash | **4MB** (1MB sketch + 3MB filesystem) |
| RAM | ~50KB SRAM (WiFi + ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ í›„ ê°€ìš© 10-18KB) |
| USB-Serial | CH340G |
| ë‚´ì¥ OLED | SSD1306 128x64, I2C @ 0x3C |
| OLED ìƒ‰ìƒ | ìƒë‹¨ 16px ë…¸ë‘ / í•˜ë‹¨ 48px íŒŒë‘ (2ìƒ‰) |
| OLED í•€ | **SDA=GPIO14, SCL=GPIO12** (ë¹„í‘œì¤€!) |
| USB | HW-364A=USB-C, HW-364B=Micro-USB (í•€ í˜¸í™˜) |

### GPIO ê°€ìš©ì„± (OLED ì ìœ  í›„)

| í•€ | GPIO | ìƒíƒœ | ë¹„ê³  |
|-----|------|------|------|
| D1 | GPIO5 | **ì‚¬ìš© ê°€ëŠ¥** | I2C SCL (ì™¸ë¶€ ì„¼ì„œ), ì¸í„°ëŸ½íŠ¸ OK |
| D2 | GPIO4 | **ì‚¬ìš© ê°€ëŠ¥** | I2C SDA (ì™¸ë¶€ ì„¼ì„œ), ì¸í„°ëŸ½íŠ¸ OK |
| D7 | GPIO13 | **ì‚¬ìš© ê°€ëŠ¥** | Digital I/O, ë¶€ì € |
| D0 | GPIO16 | **ì œí•œì ** | PWM/I2C/ì¸í„°ëŸ½íŠ¸ ë¶ˆê°€, Deep Sleep ì›¨ì´í¬ì—… ì „ìš© |
| A0 | ADC0 | **ì‚¬ìš© ê°€ëŠ¥** | ì•„ë‚ ë¡œê·¸ ì…ë ¥ (ë¹ˆë²ˆí•œ ì½ê¸° ì‹œ WiFi ê°„ì„­ ê°€ëŠ¥) |

**í•˜ë“œì›¨ì–´ SPI ì‚¬ìš© ë¶ˆê°€**: GPIO14 (HSPI_CLK), GPIO12 (HSPI_MISO)ë¥¼ OLEDì´ ì ìœ .

### ë°°ì„ ë„ (BME280, I2C ë²„ìŠ¤ ê³µìœ )

```
HW-364 ë³´ë“œ (OLED ë‚´ì¥)          BME280 ì„¼ì„œ (I2C)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
3V3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ VCC
GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GND
GPIO14 (D5) â”€â”€ OLED SDA â”€â”€â”€â”€â”€â”€â”€â”€ BME280 SDA (ë²„ìŠ¤ ê³µìœ )
GPIO12 (D6) â”€â”€ OLED SCL â”€â”€â”€â”€â”€â”€â”€â”€ BME280 SCL (ë²„ìŠ¤ ê³µìœ )

BME280 I2C ì£¼ì†Œ: 0x76 (SDO=GND) â€” OLED 0x3Cì™€ ì¶©ëŒ ì—†ìŒ
```

> **ì£¼ì˜**: ì¼ë¶€ HW-364 ìœ ë‹›ì€ SDA/SCLì´ ë’¤ë°”ë€Œì–´ ìˆìŒ. ë””ìŠ¤í”Œë ˆì´ê°€ ë™ì‘í•˜ì§€ ì•Šìœ¼ë©´ `Wire.begin(12, 14)` ì‹œë„.

---

## ğŸ—ï¸ ì†Œí”„íŠ¸ì›¨ì–´ ì•„í‚¤í…ì²˜

```
[main.cpp]
  â””â”€â”€ App (Orchestrator)
       â”œâ”€â”€ EventBus (pub/sub ëª¨ë“ˆê°„ í†µì‹ )
       â”œâ”€â”€ Core Modules
       â”‚    â”œâ”€â”€ WiFiManager (tzapu/WiFiManager)
       â”‚    â”œâ”€â”€ ConfigManager (LittleFS JSON)
       â”‚    â”œâ”€â”€ TimeManager (NTP ë™ê¸°í™”)
       â”‚    â”œâ”€â”€ CacheManager (TTL ìºì‹œ)
       â”‚    â””â”€â”€ OTAManager (ë¬´ì„  íŒì›¨ì–´ ì—…ë°ì´íŠ¸)
       â”œâ”€â”€ Feature Modules
       â”‚    â”œâ”€â”€ ClockModule (OLED ì‹œê³„)
       â”‚    â”œâ”€â”€ WeatherModule (OpenWeatherMap)
       â”‚    â”œâ”€â”€ SensorModule (BME280)
       â”‚    â”œâ”€â”€ MqttModule (256dpi/MQTT)
       â”‚    â”œâ”€â”€ NotificationModule
       â”‚    â”œâ”€â”€ ProxyManager (PC í”„ë¡ì‹œ mDNS)
       â”‚    â”œâ”€â”€ HomeAssistantModule
       â”‚    â””â”€â”€ AIModule (ë©€í‹° AI)
       â””â”€â”€ UI Layer
            â””â”€â”€ Screens (Clock, Weather, Sensor, etc.)
```

### ì£¼ìš” ì„¤ê³„ ê²°ì •

| ê²°ì • | ì„ íƒ | ê·¼ê±° |
|------|------|------|
| C++ í‘œì¤€ | **C++14** (gnu++14) | C++17ì€ ESP8266 íˆ´ì²´ì¸ì—ì„œ ë¶ˆì•ˆì • |
| WiFi ê´€ë¦¬ | **WiFiManager** | tzapu/WiFiManager, ì•ˆì •ì  Captive Portal |
| ë””ìŠ¤í”Œë ˆì´ | Adafruit SSD1306 | ê²€ì¦ëœ í˜¸í™˜ì„± (1KB í”„ë ˆì„ë²„í¼) |
| ë¬¸ìì—´ ì²˜ë¦¬ | char[] + F() ë§¤í¬ë¡œ | String í´ë˜ìŠ¤ì˜ í™ íŒŒí¸í™” ë°©ì§€ |
| ë©”ëª¨ë¦¬ í• ë‹¹ | ì •ì  í• ë‹¹ only | ëŸ°íƒ€ì„ new/malloc ê¸ˆì§€ |
| íŒŒì¼ì‹œìŠ¤í…œ | LittleFS | SPIFFS deprecated |
| lwIP ë³€í˜• | v2 Lower Memory | ë©”ëª¨ë¦¬ ì ˆì•½ |

### ë©”ëª¨ë¦¬ ì˜ˆì‚°

| êµ¬ì„± ìš”ì†Œ | ì†Œë¹„ëŸ‰ |
|-----------|--------|
| WiFi STA (ì—°ê²° ìƒíƒœ) | 20-25KB |
| SSD1306 í”„ë ˆì„ë²„í¼ | 1KB (ê³ ì •) |
| MQTT í´ë¼ì´ì–¸íŠ¸ | 1.5-3KB |
| ArduinoJson (ì¼ì‹œì ) | 1KB/ë¸”ë¡ |
| BME280 ë“œë¼ì´ë²„ | ~300B |
| **ëª¨ë“ˆ í†µí•© í›„ ê°€ìš© í™** | **~30KB** |

---

## ğŸ“š ì˜ì¡´ì„±

```ini
lib_deps =
    arkhipenko/TaskScheduler@^3.7.0
    bblanchon/ArduinoJson@^7.0.0
    256dpi/MQTT@^2.5.0
    tzapu/WiFiManager@^2.0.17
    adafruit/Adafruit SSD1306@^2.5.0
    adafruit/Adafruit BME280 Library@^2.2.0
```

---

## ğŸ› ï¸ ê°œë°œ í™˜ê²½ ì„¤ì •

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­

- Python 3.12+
- PlatformIO Core CLI

### ì„¤ì¹˜

```bash
# PlatformIO ì„¤ì¹˜
curl -fsSL -o /tmp/get-platformio.py \
  https://raw.githubusercontent.com/platformio/platformio-core-installer/master/get-platformio.py
python3 /tmp/get-platformio.py

# PATH ì¶”ê°€ (zsh)
echo 'export PATH="$HOME/.platformio/penv/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc

# udev ê·œì¹™ ì„¤ì¹˜
curl -fsSL https://raw.githubusercontent.com/platformio/platformio-core/develop/platformio/assets/system/99-platformio-udev.rules \
  | sudo tee /etc/udev/rules.d/99-platformio-udev.rules
sudo udevadm control --reload-rules && sudo udevadm trigger
```

### ë¹Œë“œ & ì—…ë¡œë“œ

```bash
# ë¹Œë“œ
pio run

# ë³´ë“œì— ì—…ë¡œë“œ
pio run --target upload

# ì‹œë¦¬ì–¼ ëª¨ë‹ˆí„°
pio device monitor --baud 115200

# ë„¤ì´í‹°ë¸Œ í…ŒìŠ¤íŠ¸
pio test -e native_test

# ì„ë² ë””ë“œ í…ŒìŠ¤íŠ¸
pio test -e embedded_test
```

---

## ğŸ–¥ï¸ ë””ìŠ¤í”Œë ˆì´ UI (2ìƒ‰ OLED)

ë…¸ë‘ ì˜ì—­(í–‰ 0-15) = ìƒíƒœë°”, íŒŒë‘ ì˜ì—­(í–‰ 16-63) = ì½˜í…ì¸ .

```
ì‹œê³„ (Phase 1):               ë‚ ì”¨ (Phase 1):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ARTHUR 22Â°C WiFi[ë…¸ë‘] â”‚     â”‚ Seoul 3Â°C     [ë…¸ë‘] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        â”‚     â”‚                        â”‚
â”‚      14:35:28          â”‚     â”‚  ë§‘ìŒ                  â”‚
â”‚   2026-03-01 (í† )       â”‚     â”‚  ì²´ê°:-1Â°C ìŠµë„:35%    â”‚
â”‚                [íŒŒë‘] â”‚     â”‚  í’ì†:3m/s      [íŒŒë‘] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ºï¸ ë¡œë“œë§µ

| Phase | ìƒíƒœ | ë‚´ìš© | ì°¸ê³  |
|-------|------|------|------|
| **Phase 0** | âœ… ì™„ë£Œ | ê°œë°œ í™˜ê²½ + OLED + WiFi ì„¤ì • | - |
| **Phase 1** | ğŸ”„ ì§„í–‰ ì¤‘ | EventBus + NTP ì‹œê³„ + ë‚ ì”¨ + ì„¼ì„œ | `.moai/specs/CODE-QUALITY/spec.md` |
| **Phase 2** | ğŸ“‹ ê³„íš | MQTT í†µì‹  + ì•Œë¦¼ | - |
| **Phase 3** | ğŸ“‹ ê³„íš | PC í”„ë¡ì‹œ + Home Assistant | - |
| **Phase 4** | ğŸ“‹ ê³„íš | ë©€í‹° AI + Deep Sleep | - |

---

## ğŸ“– ì°¸ê³  ìë£Œ

- [peff74/esp8266_OLED_HW-364A](https://github.com/peff74/esp8266_OLED_HW-364A) - HW-364A ë ˆí¼ëŸ°ìŠ¤ êµ¬í˜„
- [ESP8266 Pinout Reference](https://randomnerdtutorials.com/esp8266-pinout-reference-gpios/)
- [TaskScheduler](https://github.com/arkhipenko/TaskScheduler) - í˜‘ë ¥ì  ë©€í‹°íƒœìŠ¤í‚¹

## ğŸ“„ ë¬¸ì„œ

- **ì½”ë“œí’ˆì§ˆ ê³ ë„í™” ê³„íš**: `.moai/specs/CODE-QUALITY/spec.md`
- **ì•„í‚¤í…ì²˜ ë¶„ì„**: `.moai/specs/CODE-QUALITY/research.md`

---

## ğŸ“œ ë¼ì´ì„ ìŠ¤

MIT

---

**Last Updated**: 2026-03-01
**MoAI-ADK Version**: 4.0.0
